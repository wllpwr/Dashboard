<html>
<style>
      body {
        background-color:black
      }

      #timespot {
        color:white;
        font-size: xx-large;
        font-family: Arial, Helvetica, sans-serif;
        position: absolute;
        top:  50%;
        left: 50%;
        transform: translate(-50%,-50%);
        -webkit-user-select: none;
        user-select: none
      }

      #timeZone {
        color:white;
        font-size: small;
        font-family: Arial, Helvetica, sans-serif;
        position: absolute;
        top:  60%;
        left: 50%;
        transform: translate(-50%,-50%);
        -webkit-user-select: none;
        user-select: none
      }

  </style>
<body>
<div id="timespot">N/A</div>
<div id="timeZone">N/A</div>
<script>
        function sendMessage(fileName, jsonString) {
          Android.createAndWriteToJson(fileName, jsonString);
        }

        var settings = ""

        function getData(data) {
          console.log(data)
          settings = data
          timeNow()
        }

        window.onload = function() {
          setInterval(timeNow, 400);

          var jsonString = '[{"type": "list", "name": "timeZone", "title": "Time Zone", "summary": "Pick a Time Zone", "list": ["Local", "UTC", "UTC+1", "UTC+2", "UTC+3", "UTC+4", "UTC+5", "UTC+6", "UTC+7", "UTC+8", "UTC+9", "UTC+10", "UTC+11", "UTC+12", "UTC-1", "UTC-2", "UTC-3", "UTC-4", "UTC-5", "UTC-6", "UTC-7", "UTC-8", "UTC-9", "UTC-10", "UTC-11", "UTC-12"]}, {"type": "switch", "name": "military", "title": "Military Time", "summary": "display as Military Time"}]'

          var fileName = "timeSettings.json"

          sendMessage(fileName, jsonString)
        }

        function addZero(i) {
            if (i < 10) {i = "0" + i}
            return i;
        }

        function convertTime(i) {
            if (i > 12) {
                i = i - 12
            } else if (i == 0) {
                i = 12
            }
            return i;
        }

        function timeNow() {
            var settingsObj = JSON.parse(settings)

            var timeElement = document.getElementById("timespot");
            const d = new Date();

            if (settingsObj.timeZone == "Local") {
              var h = convertTime(d.getHours());
              var m = addZero(d.getMinutes());
              var s = addZero(d.getSeconds());

              if (settingsObj.military == "true") {
                var h = addZero(d.getHours());
              }
            } else if (settingsObj.timeZone == "UTC") {
              var h = convertTime(d.getUTCHours());
              var m = addZero(d.getUTCMinutes());
              var s = addZero(d.getUTCSeconds());

              if (settingsObj.military == "true") {
                var h = addZero(d.getUTCHours());
              }
            } else {

              if (settingsObj.timeZone[3] == "+") {
                var timeZone = settingsObj.timeZone
                timeZone = timeZone.split("+")

                var h = convertTime(d.getUTCHours() + parseInt(timeZone[1]));
                var m = addZero(d.getUTCMinutes());
                var s = addZero(d.getUTCSeconds());

                if (h > 12) {
                    h = h - 12
                }

                if (settingsObj.military == "true") {
                  var h = addZero(d.getUTCHours() + parseInt(timeZone[1]));

                  if (h > 23) {
                    h = h - 24
                  }
                }

              } else if (settingsObj.timeZone[3] == "-") {
                var timeZone = settingsObj.timeZone
                timeZone = timeZone.split("-")

                console.log("test")

                var h = convertTime(d.getUTCHours() - parseInt(timeZone[1]));

                var m = addZero(d.getUTCMinutes());
                var s = addZero(d.getUTCSeconds());

                if (h < 0) {
                    h = h + 12
                }

                if (settingsObj.military == "true") {
                  var h = addZero(d.getUTCHours() - parseInt(timeZone[1]));
                  if (h < 0) {
                    h = h + 24
                  }
                }
              }
            }
            let time = h + ":" + m + ":" + s;
            timeElement.textContent = time;
            document.getElementById("timeZone").textContent = settingsObj.timeZone;
        }
    </script>
</body>
</html>